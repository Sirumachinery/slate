
<!doctype html>
<html>
  <head>
    <link href="images/favicon.png" rel="icon" type="image/png" />
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="robots" content="noindex">
    <title>Siru Mobile API reference</title>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TFCGZ2');</script>
<!-- End Google Tag Manager -->

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;]">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TFCGZ2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="php">PHP</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#glossary" class="toc-h2 toc-link" data-title="Glossary">Glossary</a>
                  </li>
                  <li>
                    <a href="#get-started" class="toc-h2 toc-link" data-title="Get Started">Get Started</a>
                  </li>
                  <li>
                    <a href="#sdk-and-integrations" class="toc-h2 toc-link" data-title="SDK and integrations">SDK and integrations</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#environment" class="toc-h1 toc-link" data-title="Environment">Environment</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#payment-api" class="toc-h1 toc-link" data-title="Payment API">Payment API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-payment" class="toc-h2 toc-link" data-title="Create payment">Create payment</a>
                  </li>
                  <li>
                    <a href="#variants-and-testing" class="toc-h2 toc-link" data-title="Variants and testing">Variants and testing</a>
                  </li>
                  <li>
                    <a href="#signature-calculation" class="toc-h2 toc-link" data-title="Signature calculation">Signature calculation</a>
                  </li>
                  <li>
                    <a href="#field-types" class="toc-h2 toc-link" data-title="Field types">Field types</a>
                  </li>
                  <li>
                    <a href="#common-pitfalls" class="toc-h2 toc-link" data-title="Common pitfalls">Common pitfalls</a>
                  </li>
                  <li>
                    <a href="#subscriptions" class="toc-h2 toc-link" data-title="Subscriptions">Subscriptions</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#purchase-status-api" class="toc-h1 toc-link" data-title="Purchase Status API">Purchase Status API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#query-by-purchase-reference" class="toc-h2 toc-link" data-title="Query by purchase reference">Query by purchase reference</a>
                  </li>
                  <li>
                    <a href="#query-by-uuid" class="toc-h2 toc-link" data-title="Query by uuid">Query by uuid</a>
                  </li>
                  <li>
                    <a href="#query-by-date-range" class="toc-h2 toc-link" data-title="Query by date range">Query by date range</a>
                  </li>
                  <li>
                    <a href="#response-fields" class="toc-h2 toc-link" data-title="Response fields">Response fields</a>
                  </li>
                  <li>
                    <a href="#errors" class="toc-h2 toc-link" data-title="Errors">Errors</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#kyc-api" class="toc-h1 toc-link" data-title="KYC API">KYC API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#query-by-uuid-2" class="toc-h2 toc-link" data-title="Query by uuid">Query by uuid</a>
                  </li>
                  <li>
                    <a href="#errors-2" class="toc-h2 toc-link" data-title="Errors">Errors</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#price-api" class="toc-h1 toc-link" data-title="Price API">Price API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#calculate-end-user-price" class="toc-h2 toc-link" data-title="Calculate end-user price">Calculate end-user price</a>
                  </li>
                  <li>
                    <a href="#get-maximum-base-price" class="toc-h2 toc-link" data-title="Get maximum base price">Get maximum base price</a>
                  </li>
                  <li>
                    <a href="#javascript-library" class="toc-h2 toc-link" data-title="Javascript library">Javascript library</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#feature-detection-api" class="toc-h1 toc-link" data-title="Feature detection API">Feature detection API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#check-ip-address" class="toc-h2 toc-link" data-title="Check IP-address">Check IP-address</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-operational-status" class="toc-h1 toc-link" data-title="API operational status">API operational status</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#check-api-status" class="toc-h2 toc-link" data-title="Check API status">Check API status</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#maintenance" class="toc-h1 toc-link" data-title="Maintenance">Maintenance</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://sirumobile.com'>Siru Mobile</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Siru Mobile API provides a way for a merchant to accept payments from a customer via the customer&#39;s mobile phone. Customer is billed on his mobile phone bill.</p>
<h2 id='glossary'>Glossary</h2>
<table><thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>Siru Mobile</td>
<td>That’s us our payment gateway!</td>
</tr>
<tr>
<td>Merchant</td>
<td>That’s your boss, probably. Someone who sells some product payable with our payment gateway</td>
</tr>
<tr>
<td>Customer, End user</td>
<td>That’s someone using your application, paying for his purchase with our payment gateway</td>
</tr>
<tr>
<td>Variant</td>
<td>Our payment gateway contains several methods of payment or sub-API’s, so to say. We call these “variants”. Don&#39;t worry, we will tell you what variant to use.</td>
</tr>
<tr>
<td>Purchase</td>
<td>A purchase (transaction) in Siru Mobile payment gateway</td>
</tr>
</tbody></table>
<h2 id='get-started'>Get Started</h2>
<p>Integrating to Siru Mobile is easy and quick, just follow these simple steps.</p>

<ol>
<li> Contact us so we can discuss where you will be using Siru Mobile payments.</li>
<li> We provide you with sandbox credentials and details on testing and integration.</li>
<li> Read this documentation from top to bottom.</li>
<li> Code and test your application against our sandbox.</li>
<li> When ready to go live, contact us for production environment credentials.</li>
</ol>

<aside class="notice">
    We will be available for questions all the way from integration to going live. You can join our developer chat anytime where we can provide help while you test and monitor your transactions.
</aside>
<h2 id='sdk-and-integrations'>SDK and integrations</h2>
<p>We publish both ready-made libraries and a reference / example shop implementation at GitHub. It’s all free software and open source, so feel free to use them. Contributions and pull requests are appreciated!</p>

<ul>
<li> <a href="https://github.com/Sirumachinery/siru-php-sdk">PHP SDK</a></li>
<li> <a href="https://github.com/Sirumachinery/example-shop-php">Example shop</a></li>
<li> Magento plugin. Contact us!</li>
<li> WooCommerce plugin. Contact us!</li>
</ul>
<h1 id='environment'>Environment</h1>
<p>For integration and testing we provide a sandbox environment that does not use actual money. Here you can test your integration all you want and when ready, switch to production environment. Urls are the same for both environments. Only the endpoint changes.</p>

<table><thead>
<tr>
<th>Environment</th>
<th>Endpoint</th>
</tr>
</thead><tbody>
<tr>
<td>Production</td>
<td>https://payment.sirumobile.com</td>
</tr>
<tr>
<td>Sandbox</td>
<td>https://staging.sirumobile.com</td>
</tr>
</tbody></table>

<aside class="notice">
    We will provide you with separate credentials to production environment. You can not use sandbox credentials in production!
</aside>

<aside class="notice">
    The production environment imposes limits on how much the user can spend in a given time period to prevent misuse. The sandbox environment does not impose such limits.
</aside>
<h1 id='authentication'>Authentication</h1>
<p>Requests and responses are authenticated by a signature created using request values and merchant secret we have provided.</p>

<p>Contact Siru Mobile to receive your credentials. We will first provide credentials to Sandbox environment and when you are ready to go live, we will provide you with another set of credentials for production. You may receive separate credentials for each country where you are integrating.</p>
<h1 id='payment-api'>Payment API</h1><h2 id='create-payment'>Create payment</h2><h3 id='description'>DESCRIPTION</h3>
<p>Creates a new payment at Siru Mobile. You post the required parameters as JSON object in the request body. The API responds with unique UUID for the purchase and a URL where the end-user should be redirected to complete the payment.</p>
<h3 id='request'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request POST <span class="se">\</span>
    --url https://payment.sirumobile.com/payment.json <span class="se">\</span>
    --header <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    --data <span class="s2">"</span><span class="nv">$JSON</span><span class="s2">"</span>
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="c1">// Siru PHP-SDK provides helpers to sends requests
</span><span class="nv">$signature</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Siru\Signature</span><span class="p">(</span><span class="nv">$merchantId</span><span class="p">,</span> <span class="nv">$secret</span><span class="p">);</span>
<span class="nv">$api</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Siru\API</span><span class="p">(</span><span class="nv">$signature</span><span class="p">);</span>

<span class="k">try</span> <span class="p">{</span>

    <span class="nv">$transaction</span> <span class="o">=</span> <span class="nv">$api</span><span class="o">-&gt;</span><span class="na">getPaymentApi</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'variant'</span><span class="p">,</span> <span class="s1">'variant1'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'purchaseCountry'</span><span class="p">,</span> <span class="s1">'SE'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'basePrice'</span><span class="p">,</span> <span class="s1">'5.00'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'redirectAfterSuccess'</span><span class="p">,</span> <span class="s1">'https://shop.example.com/success'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'redirectAfterFailure'</span><span class="p">,</span> <span class="s1">'https://shop.example.com/fail'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'redirectAfterCancel'</span><span class="p">,</span> <span class="s1">'https://shop.example.com/cancel'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'customerNumber'</span><span class="p">,</span> <span class="s1">'0701234567'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'customerReference'</span><span class="p">,</span> <span class="s1">'c12345'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'customerEmail'</span><span class="p">,</span> <span class="s1">'john.doe@foo.bar'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'customerLocale'</span><span class="p">,</span> <span class="s1">'sv_SE'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'Game voucher'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">createPayment</span><span class="p">();</span>

    <span class="nb">header</span><span class="p">(</span><span class="s1">'location: '</span> <span class="o">.</span> <span class="nv">$transaction</span><span class="p">[</span><span class="s1">'redirect'</span><span class="p">]);</span>
    <span class="k">exit</span><span class="p">();</span>

<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">\Siru\Exception\InvalidResponseException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Connection to API failed
</span><span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">\Siru\Exception\ApiException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Error in request
</span>    <span class="k">foreach</span><span class="p">(</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getErrorStack</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Log error
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example of JSON payload</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"merchantId"</span><span class="p">:</span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"basePrice"</span><span class="p">:</span><span class="s2">"5.00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchaseCountry"</span><span class="p">:</span><span class="s2">"SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customerReference"</span><span class="p">:</span><span class="s2">"c12345"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customerNumber"</span><span class="p">:</span><span class="s2">"0701234567"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customerEmail"</span><span class="p">:</span><span class="s2">"john.doe@foo.bar"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customerLocale"</span><span class="p">:</span><span class="s2">"sv_SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"variant"</span><span class="p">:</span><span class="s2">"variant1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"redirectAfterSuccess"</span><span class="p">:</span><span class="s2">"https://shop.example.com/success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"redirectAfterFailure"</span><span class="p">:</span><span class="s2">"https://shop.example.com/fail"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"redirectAfterCancel"</span><span class="p">:</span><span class="s2">"https://shop.example.com/cancel"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="s2">"..."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><code>POST /payment.json</code></p>

<aside class="notice">
    You can also use the API by constructing a HTML form with the required parameters as input fields. Form is sent to /payment.html endpoint using POST method which will redirect user to payment page.
    This method is not recommended as it exposes more data to the end-user and prevents you from catching errors in the request.
</aside>
<h3 id='request-parameters'>REQUEST PARAMETERS</h3>
<p>Some fields are required and some are optional. To improve user experience, you should include even optional fields when available. Some fields are only required for some variants.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>variant</td>
<td>yes</td>
<td>String</td>
<td>The API variant. &#39;variant1&#39;, &#39;variant2&#39;, &#39;variant3&#39; or &#39;variant4&#39;.</td>
</tr>
<tr>
<td>merchantId</td>
<td>yes</td>
<td>Integer</td>
<td>Your merchant id provided by Siru.</td>
</tr>
<tr>
<td>submerchantReference</td>
<td></td>
<td>String</td>
<td>If same merchant id is used on multiple sites, this can be used to identify the originating site.</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>yes</td>
<td>Country</td>
<td>The country where you sell the item. Currently supported are &#39;FI&#39;, &#39;SE&#39;, &#39;NO&#39; and &#39;GB&#39;</td>
</tr>
<tr>
<td>purchaseReference</td>
<td></td>
<td>String</td>
<td>Your internal ID for the purchase. These will be visible in the merchant&#39;s control panel.</td>
</tr>
<tr>
<td>customerReference</td>
<td></td>
<td>String</td>
<td>Your internal ID for the customer. These will be visible in the merchant&#39;s control panel.</td>
</tr>
<tr>
<td>customerLastName</td>
<td></td>
<td>String</td>
<td>Customer&#39;s last name, shown in the merchant panel.</td>
</tr>
<tr>
<td>customerFirstName</td>
<td></td>
<td>String</td>
<td>Customer&#39;s first name, shown in the merchant panel.</td>
</tr>
<tr>
<td>customerPersonalId</td>
<td></td>
<td>Personal ID</td>
<td>Customer&#39;s personal ID (national ID, social security number)</td>
</tr>
<tr>
<td>customerEmail</td>
<td></td>
<td>String</td>
<td>Customer&#39;s email address, shown in the merchant panel</td>
</tr>
<tr>
<td>customerLocale</td>
<td></td>
<td>Locale</td>
<td>Language of the payment page. Defaults to the default locale of purchaseCountry. Currently supported &#39;fi_FI&#39;, &#39;sv_SE&#39;, &#39;nn_NO&#39; and &#39;en_GB&#39;.</td>
</tr>
<tr>
<td>redirectAfterSuccess</td>
<td>yes</td>
<td>URL</td>
<td>URL where the customer is redirected after a successful payment.</td>
</tr>
<tr>
<td>redirectAfterFailure</td>
<td>yes</td>
<td>URL</td>
<td>URL where the customer is redirected after an unsuccessful payment.</td>
</tr>
<tr>
<td>redirectAfterCancel</td>
<td>yes</td>
<td>URL</td>
<td>URL where the customer is redirected if he cancels the payment himself, or if the system is down for maintenance.</td>
</tr>
<tr>
<td>notifyAfterSuccess</td>
<td></td>
<td>URL</td>
<td>Your callback URL to notify after a successful purchase.</td>
</tr>
<tr>
<td>notifyAfterFailure</td>
<td></td>
<td>URL</td>
<td>Your callback URL to notify after a failed purchase.</td>
</tr>
<tr>
<td>notifyAfterCancel</td>
<td></td>
<td>URL</td>
<td>Your callback URL to notify after a canceled purchase.</td>
</tr>
<tr>
<td>basePrice</td>
<td>yes</td>
<td>Money</td>
<td>The price of the product or service. Siru&#39;s fees are added automatically. Price must include tax when applicable unless <a href="#variant2">variant2</a> is used. Maximum price or available price points depend on country and your contract with Siru Mobile.</td>
</tr>
<tr>
<td>currency</td>
<td></td>
<td>String</td>
<td>Currency code is selected automatically based on purchaseCountry but can be changed manually. Payments in currency other than the default currency must be first agreed with Siru Mobile</td>
</tr>
<tr>
<td>taxClass</td>
<td>variant1, variant2, variant4</td>
<td>Tax class</td>
<td>Tax class number. Required only if purchaseCountry is listed in Tax class-table. Must be empty otherwise. See <a href="#field-types">Field types</a>.</td>
</tr>
<tr>
<td>serviceGroup</td>
<td>variant1, variant2, variant4</td>
<td>Service group</td>
<td>Service group number. Required only if purchaseCountry is listed in Service group-table. Must be empty otherwise. See <a href="#field-types">Field types</a>.</td>
</tr>
<tr>
<td>customerNumber</td>
<td>variant1, variant4</td>
<td>Phone number</td>
<td>The customer’s phone number.</td>
</tr>
<tr>
<td>title</td>
<td>variant4</td>
<td>String</td>
<td>A short title of the purchased service or product.</td>
</tr>
<tr>
<td>description</td>
<td></td>
<td>String</td>
<td>A longer description of the purchased service or product.</td>
</tr>
<tr>
<td>interval</td>
<td></td>
<td>String</td>
<td>Subscription interval. Only available in variant4. Valid values depend on your contract</td>
</tr>
<tr>
<td>instantPay</td>
<td>variant2</td>
<td>integer</td>
<td>Deprecated. When using variant2, this value must be 1.</td>
</tr>
<tr>
<td>signature</td>
<td>yes</td>
<td>Signature</td>
<td>Calculated hash for the request. See <a href="#signature-calculation">Signature calculation</a>.</td>
</tr>
</tbody></table>

<aside class="success">
    Even if the field is not required by selected variant, you can still include it. For example while customerNumber is not required when using variant2 or variant3, you can still send it when available. This is even recommended since it may allow Siru to improve the user experience.
</aside>

<aside class="notice">
    While customerEmail and customerReference fields are not marked as required, you should always send them if available. Your contract with Siru Mobile may even require this.
</aside>

<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"success"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"uuid"</span><span class="p">:</span><span class="s2">"f9503276-80bc-4f0e-a995-16c4c7e9d0f7"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"redirect"</span><span class="p">:</span><span class="s2">"https://payment.sirumobile.com/payment/call/f9503276-80bc-4f0e-a995-16c4..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='response'>RESPONSE</h3>
<p>A JSON object with <code>success</code> boolean indicating if request was successful. If request was successful, object includes a unique id for the transaction and URL where user should be redirected.</p>

<p>If request was not successful, response includes errors array with all error messages. The errors should not be shown to end-user but instead logged for later.</p>
<h2 id='variants-and-testing'>Variants and testing</h2>
<p>Siru Mobile provides different methods of payment which we call &quot;variants&quot;. What variants are available to you depend on your contract with Siru.</p>
<h3 id='variant1'>Variant1</h3>
<p>This variant is for older phones where payment is made by calling a premium rate number. You must call from a mobile phone subscription from selected country and you can not be roaming.</p>

<table><thead>
<tr>
<th>Countries</th>
<th>Testing in sandbox</th>
</tr>
</thead><tbody>
<tr>
<td>FI, SE</td>
<td>Available price points for basePrice are 2.50, 5.00 or 10.00 for each country.<br/><br/>You can use your own mobile phone for testing.<br/><br/>The numbers you are required to call are in Sweden and calling costs only the international toll, even if the system says otherwise.</td>
</tr>
</tbody></table>

<aside class="notice">
    At the moment you can not successfully call sandbox numbers from Sweden. If needed, we can provide a Skype number for testing.
</aside>
<h3 id='variant2'>Variant2</h3>
<p>This variant is only available in Finland. It allows a fast online payment when using mobile internet connection. The purchase is billed on users mobile subscription.</p>

<table><thead>
<tr>
<th>Countries</th>
<th>Testing in sandbox</th>
</tr>
</thead><tbody>
<tr>
<td>FI</td>
<td>To simulate an error during payment, use basePrice 30.50 or 30.60.<br/><br/>In sandbox, you can use any internet connection to confirm payment. No actual charges are made.<br/><br/><a href="#feature-detection-api">Feature detection API</a> will always return true when in sandbox.</td>
</tr>
</tbody></table>

<aside class="warning">
    IMPORTANT: The basePrice value must be given without VAT. Correct tax is added to the price automatically based on taxClass value. Price can be anything between 0.10 and 60.00.
</aside>

<aside class="notice">
    Variant2 payments are only available when using mobile internet connection. You should use our Feature detection API to check if variant2 is possible for end user.
</aside>
<h3 id='variant3'>Variant3</h3>
<p>This is a digital wallet where customer can deposit money with various means (Siru Mobile payment gateway, for example) and use it everywhere where the wallet is an accepted payment method. When using Siru Mobile gateway to topup Wallet, variant1 limitations also apply.</p>

<p>The basePrice can be anything between 0.10 and 500.00. </p>

<table><thead>
<tr>
<th>Countries</th>
<th>Testing in sandbox</th>
</tr>
</thead><tbody>
<tr>
<td>FI, SE, NO</td>
<td>Use your own mobile number.<br/><br/>When using Siru Mobile gateway to topup Wallet, variant1 limitations also apply.<br/><br/>We can provide you with a test wallet for testing with fake money already deposited.</td>
</tr>
</tbody></table>
<h3 id='variant4'>Variant4</h3>
<p>Variant4 is a fast online payment currently available in the UK.</p>

<p>The maximum basePrice depends on your contract with Siru but usually it is 30.00.</p>

<table><thead>
<tr>
<th>Countries</th>
<th>Testing in sandbox</th>
</tr>
</thead><tbody>
<tr>
<td>GB</td>
<td>Use your own mobile number.</td>
</tr>
</tbody></table>
<h2 id='signature-calculation'>Signature calculation</h2><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$secret</span> <span class="o">=</span> <span class="s1">'MySecretFromSiruMobile'</span><span class="p">;</span>
<span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'variant'</span> <span class="o">=&gt;</span> <span class="s1">'variant1'</span><span class="p">,</span>
    <span class="s1">'merchantId'</span> <span class="o">=&gt;</span> <span class="s1">'123123'</span><span class="p">,</span>
    <span class="s1">'purchaseCountry'</span> <span class="o">=&gt;</span> <span class="s1">'FI'</span><span class="p">,</span>
    <span class="s1">'basePrice'</span> <span class="o">=&gt;</span> <span class="s1">'12.34'</span><span class="p">,</span>
    <span class="s1">'taxClass'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">'serviceGroup'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">'customerNumber'</span> <span class="o">=&gt;</span> <span class="s1">'050 123 4567'</span><span class="p">,</span>
    <span class="c1">// ...
</span><span class="p">);</span>
<span class="nv">$fields</span> <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span> <span class="c1">// Drop empty fields
</span><span class="nb">ksort</span><span class="p">(</span><span class="nv">$fields</span><span class="p">);</span> <span class="c1">// Sort by field name
</span><span class="nv">$signature</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s2">"sha512"</span><span class="p">,</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">';'</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">),</span> <span class="nv">$secret</span><span class="p">);</span>
</code></pre>
<p>The data must be signed using a hash from certain values in data and the merchant&#39;s secret. The signature is calculated as follows:</p>

<ol>
<li><p>Take all the fields from the table below that match the variant being used.</p></li>
<li><p>Drop all values that are empty.</p></li>
<li><p>Sort values by the field name.</p></li>
<li><p>Concatenate the values of those fields in that order, with a semicolon (‘;’) as a separator.</p></li>
<li><p>Take a SHA512-HMAC with the resulting string as data and the merchant&#39;s secret as the key.</p></li>
</ol>

<table><thead>
<tr>
<th>Field</th>
<th>Variants</th>
</tr>
</thead><tbody>
<tr>
<td>basePrice</td>
<td>All</td>
</tr>
<tr>
<td>currency</td>
<td>All</td>
</tr>
<tr>
<td>customerNumber</td>
<td>Variant1 and variant4 only</td>
</tr>
<tr>
<td>customerPersonalId</td>
<td>All</td>
</tr>
<tr>
<td>customerReference</td>
<td>All</td>
</tr>
<tr>
<td>description</td>
<td>Variant4 only</td>
</tr>
<tr>
<td>instantPay</td>
<td>Variant2 only</td>
</tr>
<tr>
<td>interval</td>
<td>Variant4 only</td>
</tr>
<tr>
<td>merchantId</td>
<td>All</td>
</tr>
<tr>
<td>notifyAfterCancel</td>
<td>All</td>
</tr>
<tr>
<td>notifyAfterFailure</td>
<td>All</td>
</tr>
<tr>
<td>notifyAfterSuccess</td>
<td>All</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>All</td>
</tr>
<tr>
<td>purchaseReference</td>
<td>All</td>
</tr>
<tr>
<td>serviceGroup</td>
<td>Variant1, variant2 and variant4 only</td>
</tr>
<tr>
<td>submerchantReference</td>
<td>All</td>
</tr>
<tr>
<td>taxClass</td>
<td>Variant1, variant2 and variant4 only</td>
</tr>
<tr>
<td>title</td>
<td>Variant4 only</td>
</tr>
<tr>
<td>variant</td>
<td>All</td>
</tr>
</tbody></table>
<h2 id='field-types'>Field types</h2><h3 id='string'>String</h3>
<p>An UTF-8 string with a maximum length of 255 characters.</p>
<h3 id='integer'>Integer</h3>
<p>A non-negative JSON integer that fits into 32 bits.</p>
<h3 id='country'>Country</h3>
<p>A ISO-3166-1 alpha-2 country code in upper case. Example &#39;FI&#39;.</p>
<h3 id='locale'>Locale</h3>
<p>The format is {Language code}_{Country code} i.e. like most POSIX locales. Currently the supported locales are fi_FI, sv_SE, nn_NO and en_GB (default) are supported.</p>
<h3 id='phone-number'>Phone number</h3>
<p>Phone number can be sent either in international MSISDN format or in national format in which case the API automatically converts the number to international format based on purchaseCountry value. A leading + character and any spaces are ignored.</p>

<p>Examples of valid phone numbers: 358501234567, +358 50 1234567, 0501234567, 050 123 4567</p>

<p>More information</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/MSISDN">http://en.wikipedia.org/wiki/MSISDN</a></li>
<li><a href="https://github.com/googlei18n/libphonenumber">libphonenumber</a> is a handy library for validating phone numbers and has been ported to multiple languages.</li>
</ul>
<h3 id='money'>Money</h3>
<p>Money fields must be given as a string with a decimal point (not a comma) and two decimal places. The two
decimal places must be given even when zero. The currency is determined by the purchaseCountry field.
Examples: 13.50, 0.20, 7.15</p>
<h3 id='personal-id'>Personal ID</h3>
<p>If end-users personal ID is provided, Siru will compare this to available KYC data and automatically
blocks payment if it does not match with users verified personal ID number.</p>

<p>This feature is only available for limited countries and is enabled only upon request. If this feature is
not enabled for your account, the field is simply ignored so there is no downside in including it.</p>

<aside class="warning">
    The personal ID must be valid in given purchaseCountry. If the personal ID is not valid in selected country, Payment API will respond with error.
</aside>
<h3 id='url'>URL</h3>
<p>An UTF-8 string that is a valid URL. The maximum length is 1024 characters. The validation is strict, so use strictly valid urls like http://example.com/?variable=value instead of http://example.com?variable=value.</p>

<p>For redirect URLs, the following parameters are added to the query. For notification URLs, the parameters are sent in a JSON object in POST body.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>siru_uuid</td>
<td>String</td>
<td>Siru&#39;s unique identifier for the purchase. 36 characters long.</td>
</tr>
<tr>
<td>siru_merchantId</td>
<td>Integer</td>
<td>The merchantId given in the request.</td>
</tr>
<tr>
<td>siru_submerchantReference</td>
<td>String</td>
<td>The submerchantReference given in the request.</td>
</tr>
<tr>
<td>siru_purchaseReference</td>
<td>String</td>
<td>The purchaseReference given in the request.</td>
</tr>
<tr>
<td>siru_event</td>
<td>String</td>
<td>One of the following: success, failure or cancel.</td>
</tr>
<tr>
<td>siru_signature</td>
<td>String</td>
<td>See below.</td>
</tr>
</tbody></table>

<p>siru_signature is similar to the request&#39;s signature and you <strong>must</strong> use it to validate authenticity of the parameters. It is calculated by concatenating the values (including empty values) of siru_uuid, siru_merchantId, siru_submerchantReference, siru_purchaseReference and siru_event (in that order) with a semicolon (‘;’) as a separator and taking a SHA512-HMAC with the resulting string as data and the merchant secret as key.</p>

<p>If your redirect page does anything that depends on the purchase being completed successfully, then you must verify that siru_signature and siru_event are correct! Attacker may try and direct his browser to send failure parameters to the success URL.</p>

<p>The customer may fail to arrive at any of the redirect URLs for various reasons, such as connection loss or user error. Relying on the notifyAfter* URLs for purchase confirmation is therefore recommended, even though it is takes some extra effort.</p>

<p>Your server should respond to the notification with HTTP 200 code. If the notification fails, either due to a network error or with a non-200 code, then it is retried for 7 days. This time limit may change in the future.</p>

<aside class="warning">
    In very rare (and theoretically unavoidable) corner cases, it is possible for a notification to be delivered more than once. Your system should be prepared to ignore a second notification, preferably with 200 code.
</aside>
<h3 id='tax-class'>Tax class</h3>
<p>This specifies the Value Added Tax class. If your country is not listed here, leave this field empty.</p>

<table><thead>
<tr>
<th>Num.</th>
<th>Countries</th>
<th>VAT %</th>
</tr>
</thead><tbody>
<tr>
<td>0</td>
<td>Finland</td>
<td>0%</td>
</tr>
<tr>
<td>1</td>
<td>Finland</td>
<td>10%</td>
</tr>
<tr>
<td>2</td>
<td>Finland</td>
<td>14%</td>
</tr>
<tr>
<td>3</td>
<td>Finland</td>
<td>24%</td>
</tr>
</tbody></table>

<p>Tax classes may be added, changed and removed as legislation changes. Siru will notify merchants in advance of such changes. Tax class number 0 will, however, always mean a 0% VAT.</p>

<p>More information<br></p>

<ul>
<li><a href="http://www.vero.fi/fi-FI/Yritys_ja_yhteisoasiakkaat/Liikkeen_ja_ammatinharjoittaja/Arvonlisaverotus">http://www.vero.fi/fi-FI/Yritys_ja_yhteisoasiakkaat/Liikkeen_ja_ammatinharjoittaja/Arvonlisaverotus</a> (in Finnish)<br></li>
<li><a href="http://www.vero.fi/en-US/Companies_and_organisations/VAT">http://www.vero.fi/en-US/Companies_and_organisations/VAT</a> (in English)</li>
</ul>
<h3 id='service-group'>Service group</h3>
<p>This specifies the service group of the product or service. If your country is not listed here, leave this field empty.</p>

<table><thead>
<tr>
<th>Num.</th>
<th>Countries</th>
<th>FICORA title</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>Finland</td>
<td>Non-profit services</td>
</tr>
<tr>
<td>2</td>
<td>Finland</td>
<td>Online services</td>
</tr>
<tr>
<td>3</td>
<td>Finland</td>
<td>Entertainment services</td>
</tr>
<tr>
<td>4</td>
<td>Finland</td>
<td>Adult entertainment services</td>
</tr>
</tbody></table>

<p>A customer&#39;s phone subscription may bar calls to certain service groups. The service groups also show up on the customer&#39;s phone bill breakdown. If multiple service groups apply, then the group with the highest number must be chosen. Contact Siru for further advice if you have any doubt.</p>

<p>The service group scheme may change as legislation changes. Siru will notify merchants in advance if any changes are required.</p>

<p>More information<br></p>

<ul>
<li><a href="http://www.mapel.fi/eettiset_saannot/palveluiden_luokittelu/">http://www.mapel.fi/eettiset_saannot/palveluiden_luokittelu/</a></li>
</ul>
<h3 id='signature'>Signature</h3>
<p>SHA512-HMAC hash calculated from selected field values and merchant&#39;s secret. See <a href="#signature-calculation">Signature calculation</a>.</p>
<h2 id='common-pitfalls'>Common pitfalls</h2>
<p>We have gathered here some of the more common mistakes you might encounter during integration.</p>
<h3 id='invalid-mobile-number'>Invalid mobile number</h3>
<p>We use very strict validation for phone numbers ie. the customerNumber field. See <a href="#phone-number">Phone number</a>. You should validate phone number carefully. Often we see numbers with missing 0 prefix (national format), missing country code (international format) or with both 0 and country code prefix which is invalid.</p>

<p>Examples of <strong>invalid</strong> values: 3580501234567, 501234567</p>
<h3 id='invalid-price-point'>Invalid price point</h3>
<p>When creating variant1 transaction, we have sent you a list of price points that you can use as base price. Trying to create a variant1 transaction with a price point that is not available will result in error.</p>

<p>With other variants, there are no fixed price points but there is a maximum value for basePrice in each country.</p>
<h3 id='invalid-variant-for-given-country'>Invalid variant for given country</h3>
<p>Usually we have only enabled one variant per country for you to use. For example variant3 in Norway and variant1 in Finland. If you mix these, the API call will result in an error.</p>
<h3 id='monitoring-errors'>Monitoring errors</h3>
<p>You and we at Siru want to keep the end-users happy and not miss any sales. If a bug has made its way to your code and the API call fails, we log the error automatically. You can monitor failed API calls from our Merchant panel. Contact us if you have not received your credentials to our Merchant panel.</p>
<h2 id='subscriptions'>Subscriptions</h2>
<p>If you have subscriptions enabled with Siru Mobile, you can create a new payment that is automatically renewed on agreed upon intervals. When using subscriptions, there are some things you must take in to account.</p>
<h3 id='notifications'>Notifications</h3>
<p>To receive notification when payment is renewed, you must provide notifyAfterSuccess URL. This is the only way to know when payment has been renewed.</p>
<h3 id='purchase-reference-and-uuid'>Purchase reference and UUID</h3>
<p>When creating a new subscription, you must use a unique purchaseReference. When payment is automatically renewed, the notification will have the same purchaseReference as the original payment.</p>

<p>When creating a new subscription, store the UUID you receive from Payment API. You need this if you need to end subscription manually.</p>
<h1 id='purchase-status-api'>Purchase Status API</h1>
<p>The purchase status API provides information about statuses of purchases.</p>

<p>There are three ways to query:</p>

<ul>
<li>  by the merchant provided purchaseReference field</li>
<li>  by the Siru-assigned UUID</li>
<li>  by a date range.</li>
</ul>
<h2 id='query-by-purchase-reference'>Query by purchase reference</h2><h3 id='description-2'>DESCRIPTION</h3>
<p>Search transactions that match given purchase reference.</p>
<h3 id='request-2'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/byPurchaseReference.json <span class="se">\</span>
    -d <span class="s1">'merchantId=1'</span> <span class="se">\</span>
    -d <span class="s1">'purchaseReference=p12345678'</span> <span class="se">\</span>
    -d <span class="s1">'signature=mycalculatedhash'</span>
</code></pre>
<p><code>GET /payment/byPurchaseReference.json</code></p>
<h3 id='request-parameters-2'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>submerchantReference</td>
<td>String</td>
<td>Submerchant reference. If not empty, only transactions from this submerchant are included. Otherwise all matching transactions are included.</td>
</tr>
<tr>
<td>purchaseReference</td>
<td>String</td>
<td>The purchase reference.</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Concatenate the values (including empty values) of merchantId, submerchantReference and purchaseReference (in that order), with &#39;;&#39; as the separator. Take the SHA512-HMAC of that with the merchant&#39;s secret as the key.</td>
</tr>
</tbody></table>

<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"purchases"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e53c3cfc-6d5b-4af3-ae30-7ae7812c9cf7"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"submerchantReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"customerReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"purchaseReference"</span><span class="p">:</span><span class="s2">"testshop1420070765"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unconfirmed"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"basePrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12.34"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"finalPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12.55"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-13T12:51:33+0200"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"startedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-13T12:51:58+0200"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"finishedAt"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"customerNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"358501234567"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='response-2'>RESPONSE</h3>
<p>JSON object with a single property &quot;purchases&quot; which contains array of matching transactions.</p>

<aside class="notice">
    Siru does not enforce the uniqueness of purchase reference so you may get more than one result. The results are sorted newest first.
</aside>
<h2 id='query-by-uuid'>Query by uuid</h2><h3 id='description-3'>DESCRIPTION</h3>
<p>Find a single transaction by UUID.</p>
<h3 id='request-3'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/byUuid.json <span class="se">\</span>
    -d <span class="s1">'merchantId=1'</span> <span class="se">\</span>
    -d <span class="s1">'uuid=061d488d-ab43-458d-9b5e-0b2005595d7e'</span> <span class="se">\</span>
    -d <span class="s1">'signature=mycalculatedhash'</span>
</code></pre>
<p><code>GET /payment/byUuid.json</code></p>
<h3 id='request-parameters-3'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>uuid</td>
<td>String</td>
<td>The UUID to query by</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Concatenate the values of merchantId and uuid (in that order), with &#39;;&#39; as a separator. Take the SHA512-HMAC of that with the merchant&#39;s secret as the key.</td>
</tr>
</tbody></table>
<h3 id='response-3'>RESPONSE</h3>
<p>The response is a single transaction object. If UUID is not found, an error with HTTP 404 status is returned.</p>
<h2 id='query-by-date-range'>Query by date range</h2><h3 id='description-4'>DESCRIPTION</h3>
<p>Search all transactions that were created during given time period.</p>
<h3 id='request-4'>REQUEST</h3><pre class="highlight shell tab-shell"><code><span class="c"># Retrieve transactions for december 2017</span>
curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/byDate.json <span class="se">\</span>
    -d <span class="s1">'merchantId=1'</span> <span class="se">\</span>
    -d <span class="s1">'from=2017-12-01 00:00:00'</span> <span class="se">\</span>
    -d <span class="s1">'to=2018-01-01 00:00:00'</span> <span class="se">\</span>
    -d <span class="s1">'signature=mycalculatedhash'</span>
</code></pre>
<p><code>GET /payment/byDate.json</code></p>
<h3 id='request-parameters-4'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>from</td>
<td>String</td>
<td>Lower date limit (UTC). Purchases with this datetime will be included in the result. Format: yyyy-mm-dd hh:ii:ss (2015-01-01 00:00:00).</td>
</tr>
<tr>
<td>to</td>
<td>String</td>
<td>Upper date limit (UTC). Purchases with this datetime will be excluded from the result. Format: yyyy-mm-dd hh:ii:ss (2015-01-01 00:00:00).</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Concatenate the values of merchantId, from and to (in that order), with &#39;;&#39; as a separator. Take the SHA512-HMAC of that with the merchant&#39;s secret as the key.</td>
</tr>
</tbody></table>

<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"purchases"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uuid"</span><span class="p">:</span><span class="s2">"f599cd21-47a2-4bbc-b44b-2cc4b1bb25f1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"merchantId"</span><span class="p">:</span><span class="s2">"18"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"submerchantReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"customerReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"purchaseReference"</span><span class="p">:</span><span class="s2">"testshop1420070765"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"customerNumber"</span><span class="p">:</span><span class="s2">"XXXXXXX"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"basePrice"</span><span class="p">:</span><span class="s2">"5.00"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"finalPrice"</span><span class="p">:</span><span class="s2">"8.51"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"canceled"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="s2">"2015-01-01T00:06:05+0000"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"startedAt"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"finishedAt"</span><span class="p">:</span><span class="s2">"2015-01-01T00:17:09+0000"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre><h3 id='response-4'>RESPONSE</h3>
<p>JSON object with a single property &quot;purchases&quot; which contains array of matching transactions. The transaction objects will include some additional fields for your leisure!</p>
<h2 id='response-fields'>Response fields</h2>
<blockquote>
<p>Example of transaction object returned by status API</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e53c3cfc-6d5b-4af3-ae30-7ae7812c9cf7"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"submerchantReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"customerReference"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"purchaseReference"</span><span class="p">:</span><span class="s2">"testshop1420070765"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unconfirmed"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"basePrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12.34"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"finalPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12.55"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"createdAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-13T12:51:33+0200"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"startedAt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-13T12:51:58+0200"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"finishedAt"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"customerNumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"358501234567"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The basic transaction object returned by search includes fields</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>uuid</td>
<td>Siru unique UUID for this transaction</td>
</tr>
<tr>
<td>submerchantReference</td>
<td>Sub-merchant reference sent by you</td>
</tr>
<tr>
<td>customerReference</td>
<td>Customer reference sent by you</td>
</tr>
<tr>
<td>purchaseReference</td>
<td>Purchase reference sent by you</td>
</tr>
<tr>
<td>status</td>
<td>Purchase current status, see below table</td>
</tr>
<tr>
<td>basePrice </td>
<td>The original price sent by you</td>
</tr>
<tr>
<td>finalPrice</td>
<td>The price user was charged with possible commission included</td>
</tr>
<tr>
<td>currency</td>
<td>Payment currency</td>
</tr>
<tr>
<td>createdAt</td>
<td>ISO-8601 date when transaction was created</td>
</tr>
<tr>
<td>startedAt</td>
<td>ISO-8601 date when customer started payment</td>
</tr>
<tr>
<td>finishedAt</td>
<td>ISO-8601 date when purchase was finalized</td>
</tr>
<tr>
<td>customerNumber</td>
<td>Customers phone number if available</td>
</tr>
</tbody></table>

<p>The possible values for &quot;status&quot; are as follows:</p>

<table><thead>
<tr>
<th>Status</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>new</td>
<td>Siru has received the purchase but the customer has not yet initiated payment.</td>
</tr>
<tr>
<td>unconfirmed</td>
<td>The customer is undergoing phone number verification.</td>
</tr>
<tr>
<td>call_started</td>
<td>The customer has initiated payment by calling Siru&#39;s payment number.</td>
</tr>
<tr>
<td>confirmed</td>
<td>The payment is successful.</td>
</tr>
<tr>
<td>canceled</td>
<td>The user has chosen to cancel the payment.</td>
</tr>
<tr>
<td>failed</td>
<td>The purchase has failed due to an error. The merchant panel may provide more information.</td>
</tr>
</tbody></table>

<p>The states confirmed, canceled and failed are final states. Any other state should be considered as intermediate and subject to change. Once purchase reaches a final state, it will not leave that state.</p>

<p>Backwards-compatibility is guaranteed as follows: Siru may add or remove only non-final states.</p>
<h2 id='errors'>Errors</h2>
<blockquote>
<p>Failure response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">404</span><span class="p">,</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Not Found"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>HTTP status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td>403</td>
<td>Invalid signature or purchase does not belong to you</td>
</tr>
<tr>
<td>404</td>
<td>Purchase by UUID was not found</td>
</tr>
</tbody></table>
<h1 id='kyc-api'>KYC API</h1>
<p>The KYC API can be used to retrieve end-user KYC information after successful payment. KYC data is availabe
for limited countries only and is available for limited time only after payment is confirmed.</p>

<p>This API is only available upon request. Please contact our developer support or sales if you need access to this API.</p>
<h2 id='query-by-uuid-2'>Query by uuid</h2><h3 id='description-5'>DESCRIPTION</h3>
<p>Lookup KYC information for payment by UUID. </p>
<h3 id='request-5'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/kyc <span class="se">\</span>
    -d <span class="s1">'merchantId=1'</span> <span class="se">\</span>
    -d <span class="s1">'uuid=061d488d-ab43-458d-9b5e-0b2005595d7e'</span> <span class="se">\</span>
    -d <span class="s1">'signature=mycalculatedhash'</span>
</code></pre>
<p><code>GET /payment/kyc</code></p>
<h3 id='request-parameters-5'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>uuid</td>
<td>String</td>
<td>The UUID to query by</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Concatenate the values of merchantId and uuid (in that order), with &#39;;&#39; as a separator. Take the SHA512-HMAC of that with the merchant&#39;s secret as the key.</td>
</tr>
</tbody></table>
<h3 id='response-5'>RESPONSE</h3>
<blockquote>
<p>Example report</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"report"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"James"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"lastName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>If KYC data is available, response JSON contains key &quot;report&quot; with end-users verified firstName and lastName.
If UUID is not found or KYC data is no longer available, HTTP 404 is returned.</p>
<h2 id='errors-2'>Errors</h2>
<blockquote>
<p>Failure response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">404</span><span class="p">,</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Not Found"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>HTTP status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td>403</td>
<td>Invalid signature or KYC API is not enabled</td>
</tr>
<tr>
<td>404</td>
<td>Purchase was not found or KYC data is no longer available</td>
</tr>
</tbody></table>
<h1 id='price-api'>Price API</h1><h2 id='calculate-end-user-price'>Calculate end-user price</h2><h3 id='description-6'>DESCRIPTION</h3>
<p>Siru will automatically add possible fees and commissions to transaction base price. Since the exact formula for calculating the final price is somewhat intricate and subject to change, this API allows you to calculate the final price to display it to the end-user.</p>
<h3 id='request-6'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/price.json <span class="se">\</span>
    -d <span class="s1">'variant=variant1'</span> -d <span class="s1">'merchantId=18'</span> -d <span class="s1">'purchaseCountry=FI'</span> -d <span class="s1">'taxClass=3'</span> -d <span class="s1">'basePrice=15.00'</span>
</code></pre>
<p><code>GET /payment/price.json</code></p>
<h3 id='request-parameters-6'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>variant</td>
<td>String</td>
<td>variant1 or variant4</td>
</tr>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>submerchantReference (optional)</td>
<td>String</td>
<td>Submerchant reference, if any.</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>Country</td>
<td>The country where the merchant sells the item.</td>
</tr>
<tr>
<td>taxClass <br>(optional*)</td>
<td>Tax class</td>
<td>The tax class number.</td>
</tr>
<tr>
<td>basePrice</td>
<td>Money</td>
<td>The price of the product with VAT included.</td>
</tr>
<tr>
<td>callback <br>(optional)</td>
<td>String</td>
<td>The JSONP callback name, if you are using JSONP.</td>
</tr>
</tbody></table>

<aside class="notice">
    This API is only available for variant1 and variant4 payments.
</aside>

<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"finalCallPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13.57"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='response-6'>RESPONSE</h3>
<p>Response is a JSON object with single property &quot;finalCallPrice&quot;.</p>

<blockquote>
<p>Failure response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"technical error message in English"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre><h3 id='errors-3'>ERRORS</h3>
<p>If an error occurs, the response is a JSON object with single property &quot;error&quot; with error message. The error message should not be shown to end user.</p>
<h2 id='get-maximum-base-price'>Get maximum base price</h2><h3 id='description-7'>DESCRIPTION</h3>
<p>Siru imposes a limit on the maximum price of a purchase. The limit is fairly stable, so it may be acceptable to hard-code it into your application. Nevertheless, the limit can be retrieved through a JSON API.</p>
<h3 id='request-7'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/maxPrice.json <span class="se">\</span>
    -d <span class="s1">'variant=variant1'</span> -d <span class="s1">'merchantId=18'</span> -d <span class="s1">'purchaseCountry=FI'</span> -d <span class="s1">'taxClass=3'</span>
</code></pre>
<p><code>GET /payment/maxPrice.json</code></p>
<h3 id='request-parameters-7'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>variant</td>
<td>String</td>
<td>variant1</td>
</tr>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>submerchantReference<br>(optional)</td>
<td>String</td>
<td>Submerchant reference, if any</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>Country</td>
<td>The country where the merchant sells the item.</td>
</tr>
<tr>
<td>taxClass <br>(optional*)</td>
<td>Tax class</td>
<td>The tax class number.</td>
</tr>
<tr>
<td>callback <b>(optional)</td>
<td>String</td>
<td>The JSONP callback name, if you are using JSONP.</td>
</tr>
</tbody></table>

<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"maxBasePrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39.40"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"maxFinalCallPrice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40.00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='response-7'>RESPONSE</h3>
<p>Response is a JSON object with two properties</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>maxBasePrice</td>
<td>The maximum available base price.</td>
</tr>
<tr>
<td>maxFinalCallPrice</td>
<td>The final price of maxBasePrice.</td>
</tr>
</tbody></table>

<aside class="notice">
    Customers may also have individual spending limits with Siru. This API does not take those into account.
</aside>

<aside class="notice">
    This API is only available for checking variant1 maximum base price.
</aside>

<blockquote>
<p>Failure response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"technical error message in English"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre><h3 id='errors-4'>ERRORS</h3>
<p>Errors are JSON objects with single property &quot;error&quot;. The error message should not be shown to end user. Response will include one of the following HTTP status codes.</p>

<table><thead>
<tr>
<th>HTTP status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>404</td>
<td>One of the request parameters was invalid</td>
</tr>
<tr>
<td>500</td>
<td>An unknown error</td>
</tr>
</tbody></table>
<h2 id='javascript-library'>Javascript library</h2>
<p>Siru provides a small JavaScript convenience library.</p>
<h3 id='installation'>Installation</h3>
<p>Use the script tag below to include the library. You may copy the library to your site, but it is recommended to include it directly to obtain any future updates. Updates will be backwards-compatible.</p>

<p><code>&lt;script src=&quot;https://payment.sirumobile.com/js/lib/siru.js&quot;&gt;&lt;/script&gt;</code></p>

<p>The library depends on jQuery 1.5+. jQuery must be included before the Siru library so that the global jQuery object is available.</p>

<p>The library defines the global object Siru. Including it has no other effects.</p>
<h3 id='price-calculation'>Price calculation</h3>
<p>Siru.getPrice(params) uses the price calculation API to fetch the final call price given a base price.</p>

<p>params must be an object with the following fields:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>variant</td>
<td>String</td>
<td>variant1</td>
</tr>
<tr>
<td>basePrice</td>
<td>Money</td>
<td>The price of the product with VAT included. A decimal value (with &#39;.&#39; as separator).</td>
</tr>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>submerchantReference<br>(optional)</td>
<td>String</td>
<td>Submerchant reference, if any.</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>Country</td>
<td>The country where the merchant sells the item.</td>
</tr>
<tr>
<td>taxClass <br>(optional*)</td>
<td>Tax class</td>
<td>The tax class number. * Must be set if purchase country has options listed. Must be empty otherwise.</td>
</tr>
<tr>
<td>success</td>
<td>Callback</td>
<td>A function that is called when the request succeeds. The price will be given as a parameter (a decimal number string).</td>
</tr>
<tr>
<td>error</td>
<td>Callback</td>
<td>A function that is called when the request fails or times out. A technical error message is given as a parameter.</td>
</tr>
<tr>
<td>timeout<br>(optional)</td>
<td>Integer</td>
<td>A timeout, in milliseconds. Defaults to 15000ms.</td>
</tr>
</tbody></table>

<p>The function calls success or error when the request completes. It returns an object that has an abort method that cancels the request. If abort is used then neither success nor error will be called.</p>
<h3 id='get-maximum-base-price-2'>Get maximum base price</h3>
<p>Siru.getMaxBasePrice(params) uses the maximum price API to fetch the maximum base price that Siru will accept.</p>

<p>params must be an object with the following fields.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>variant</td>
<td>String</td>
<td>variant1</td>
</tr>
<tr>
<td>basePrice</td>
<td>Money</td>
<td>The price of the product with VAT included. A decimal value (with &#39;.&#39; as separator)</td>
</tr>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>submerchantReference<br> (optional)</td>
<td>String</td>
<td>Submerchant reference, if any.</td>
</tr>
<tr>
<td>purchaseCountry</td>
<td>Country</td>
<td>The country where the merchant sells the item.</td>
</tr>
<tr>
<td>taxClass <br>(optional*)</td>
<td>Tax class</td>
<td>The tax class number. * Must be set if purchase country has options listed. Must be empty otherwise.</td>
</tr>
<tr>
<td>success</td>
<td>Callback</td>
<td>A function that is called when the request succeeds. The price will be given as a parameter (a decimal number string).</td>
</tr>
<tr>
<td>error</td>
<td>Callback</td>
<td>A function that is called when the request fails or times out. A technical error message is given as a parameter.</td>
</tr>
<tr>
<td>timeout <br>(optional)</td>
<td>Integer  A timeout, in milliseconds. Defaults to 15000ms.</td>
<td></td>
</tr>
</tbody></table>

<p>The function calls success or error when the request completes. It returns an object that has an abort method that cancels the request. If abort is used then neither success nor error will be called.</p>
<h1 id='feature-detection-api'>Feature detection API</h1><h2 id='check-ip-address'>Check IP-address</h2><h3 id='description-8'>DESCRIPTION</h3>
<p>The Feature detection API can be used to verify if IP Payments (variant2) are available for given IP-address.</p>
<h3 id='request-8'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl --request GET -G <span class="se">\</span>
    --url https://payment.sirumobile.com/payment/ip/feature-check <span class="se">\</span>
    -d <span class="s1">'merchantId=18'</span> -d <span class="s1">'ip=12.12.12.12'</span> -d <span class="s1">'signature=mycalculatedhash'</span>
</code></pre>
<p><code>GET /payment/ip/feature-check</code></p>
<h3 id='request-parameters-8'>REQUEST PARAMETERS</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Format</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>merchantId</td>
<td>Integer</td>
<td>Your merchant ID</td>
</tr>
<tr>
<td>ip</td>
<td>String</td>
<td>End-users IP address</td>
</tr>
<tr>
<td>signature</td>
<td>String</td>
<td>Concatenate the values (including empty values) of merchantId and ip (in that order), with &#39;;&#39; as the separator. Take the SHA512- HMAC of that with the merchant&#39;s secret as the key.</td>
</tr>
</tbody></table>

<blockquote>
<p>Response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"ipPaymentsEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre><h3 id='response-8'>RESPONSE</h3><h3 id='errors-5'>ERRORS</h3>
<blockquote>
<p>Failure response example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">403</span><span class="p">,</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="s2">"Forbidden"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p>Errors are JSON objects with single property &quot;error&quot;. Response will include one of the following HTTP status codes.</p>

<table><thead>
<tr>
<th>HTTP status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>403</td>
<td>Invalid signature</td>
</tr>
</tbody></table>
<h1 id='api-operational-status'>API operational status</h1><h2 id='check-api-status'>Check API status</h2><h3 id='description-9'>DESCRIPTION</h3>
<p>Check operational status of Siru Mobile API.</p>
<h3 id='request-9'>REQUEST</h3><pre class="highlight shell tab-shell"><code>curl -w <span class="s2">"%{http_code}"</span> --url https://payment.sirumobile.com/status
</code></pre>
<p><code>GET /status</code></p>
<h3 id='request-parameters-9'>REQUEST PARAMETERS</h3>
<p>None</p>
<h3 id='response-9'>RESPONSE</h3>
<p>The response HTTP status code will tell you the operational status of the API.</p>

<table><thead>
<tr>
<th>HTTP status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>Siru Mobile is up and all should be well.</td>
</tr>
<tr>
<td>503</td>
<td>Siru Mobile is temporarily down for maintenance. Usually this doesn&#39;t last longer than a few minutes.</td>
</tr>
<tr>
<td>500</td>
<td>There is a problem with Siru Mobile API. You should never get this response from status query.</td>
</tr>
</tbody></table>
<h1 id='maintenance'>Maintenance</h1>
<p>Occasionally we will do maintenance on Siru Mobile API which may require a temporary down time. Don&#39;t worry: we handle all your customers&#39; ongoing purchases gracefully and (if the need for maintenance isn&#39;t surprising or urgent) you should also know about all our maintencance windows in advance.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="php">PHP</a>
          </div>
      </div>
    </div>
  </body>
</html>
